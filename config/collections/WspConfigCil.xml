<?xml version="1.0"?>
<wsp>
  <collection>
    <id>cil</id>
    <rdfId>http://wsp.normdata.rdf/CorpusInscriptLatinarum</rdfId>
    <name>Corpus Inscriptionum Latinarum</name>
    <url>
    	<webBaseUrl>http://cil.bbaw.de/</webBaseUrl>
      <dataUrl>http://cil.bbaw.de/</dataUrl>
    </url>
    <languages>ger, lat</languages>
    <mainLanguage>ger</mainLanguage>
    <formats>
      <format>html</format>
      <format>php</format>
    </formats>
    <db>
      <type>mysql</type>
      <name>cil</name>
      <xmlDump>
        <sql>
SELECT 
 tits.title_id as id,
 GROUP_CONCAT(persons.last_name, ', ', persons.first_name ORDER BY persons.last_name SEPARATOR ' ; ') as creator,
 tits.title as title,
 IF(CHAR_LENGTH(tits.pub_editor) = 0, IFNULL(tits.pub_location, ''), CONCAT(tits.pub_editor, ', ', IFNULL(tits.pub_location, ''))) as publisher,
 tits.pub_year as pub_date,
 tits.pages as pages,
 tits.keywords as subject
FROM 
(SELECT 
  titles.*, 
  GROUP_CONCAT(keywords.keyword ORDER BY keywords.keyword SEPARATOR '###') as keywords
 FROM titles, titles_keywords, keywords
 WHERE 
  titles_keywords.title_id = titles.title_id
 AND
  titles_keywords.keyword_id = keywords.keyword_id
 GROUP BY titles.title_id
) as tits, 
titles_persons, 
persons
WHERE
 titles_persons.title_id = tits.title_id
AND
 titles_persons.person_id = persons.person_id
GROUP BY tits.title_id
        </sql>
        <fileName>config/mdsystem/db-resources/cil.xml</fileName>
      </xmlDump>
      <mainResourcesTable>
        <name>titles_persons</name>
        <idField>id</idField>
        <field>
          <dc>creator</dc>
          <db>creator</db>
        </field>
        <field>
          <dc>title</dc>
          <db>title</db>
        </field>
        <field>
          <dc>publisher</dc>
          <db>publisher</db>
        </field>
        <field>
          <dc>date</dc>
          <db>pub_date</db>
        </field>
        <field>
          <dc>extent</dc>
          <db>pages</db>
        </field>
        <field>
          <dc>subject</dc>
          <db>subject</db>
        </field>
        <field>
          <dc>language</dc>
          <db>language</db> 
        </field>
      </mainResourcesTable>
      <webId>
        <preStr>http://cil.bbaw.de/dateien/cil_pgsql_query.php?&amp;mnum=</preStr>
      </webId>
    </db>
  </collection>
</wsp>